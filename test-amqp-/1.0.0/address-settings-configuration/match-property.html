<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>match property :: Address Settings for AMQ Broker on OpenShift</title>
    <link rel="prev" href="address-settings-configuration.html">
    <link rel="next" href="enclosing-value-in-single-quotation-marks-for-example-myotheraddresses.html">
    <meta name="generator" content="Antora 3.1.3">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://www.redhat.com" target="_blank"><img src="../../../_/img/redhat-logo.png" height="40px" alt="Red Hat"></a>
      <a class="navbar-item" style="font-size: 24px; color: white" href="../../..">Address Settings for AMQ Broker on OpenShift</a>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/RedHatQuickCourses/REPLACEREPONAME/issues" target="_blank">Report Issues</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="test-amqp-" data-version="1.0.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Address Settings for AMQ Broker on OpenShift</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Home</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../LABENV/index.html">Lab Environment</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../configuring-address-settings/configuring-address-settings.html">Configuring Address Settings</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuring-address-settings/using-brokerproperties-attribute-in-activemqartemis-cr-instance.html">Using brokerProperties attribute in ActiveMQArtemis CR instance</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuring-address-settings/configuring-address-settings-under-brokerproperties.html">Configuring address settings under brokerProperties</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuring-address-settings/example-configuring-dead-letter-address-and-queue-for-specific-address-patterns.html">Example: Configuring dead letter address and queue for specific address patterns</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuring-address-settings/using-activemqartemisaddress-cr-instance.html">Using ActiveMQArtemisAddress CR instance</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuring-address-settings/configuring-address-settings-in-addresssettings-section-of-activemqartemis-cr.html">Configuring address settings in addressSettings section of ActiveMQArtemis CR</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../configuring-address-settings/example-configuring-dead-letter-address-and-queue-for-specific-address-patterns.html">Example: Configuring dead letter address and queue for specific address patterns</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="address-settings-configuration.html">Address Settings Configuration</a>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="match-property.html">match property</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="enclosing-value-in-single-quotation-marks-for-example-myotheraddresses.html">Enclosing value in single quotation marks, for example, myOtherAddresses#</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="applyrule-property.html">applyRule property</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="specifying-how-the-operator-applies-the-configuration.html">Specifying how the Operator applies the configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="example-merge_all.html">Example: merge_all</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../avoiding-default-configuration-inclusion/avoiding-default-configuration-inclusion.html">Avoiding Default Configuration Inclusion</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../avoiding-default-configuration-inclusion/not-including-properties-specified-in-the-default-configuration-even-if-not-specified-in-the-cr.html">Not including properties specified in the default configuration, even if not specified in the CR</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../overlapping-address-settings/overlapping-address-settings.html">Overlapping Address Settings</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../overlapping-address-settings/ensuring-not-to-include-properties-with-the-same-value-in-both-cr-and-default-entry-sub-entry.html">Ensuring not to include properties with the same value in both CR and default Entry Sub-entry</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../appendix/appendix.html">Appendix</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Address Settings for AMQ Broker on OpenShift</span>
    <span class="version">1.0.0</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../index.html">Address Settings for AMQ Broker on OpenShift</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">1.0.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Address Settings for AMQ Broker on OpenShift</a></li>
    <li><a href="address-settings-configuration.html">Address Settings Configuration</a></li>
    <li><a href="match-property.html">match property</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">match property</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This section describes the <code>match</code> property used in Address Settings for AMQ Broker on OpenShift.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_match_property"><a class="anchor" href="#_match_property"></a>match property</h3>
<div class="paragraph">
<p>The <code>match</code> property is a crucial component of address settings, allowing you to associate a specific set of configuration rules with one or more addresses on the AMQ Broker.</p>
</div>
<div class="sect3">
<h4 id="_description_and_usage"><a class="anchor" href="#_description_and_usage"></a>Description and Usage</h4>
<div class="paragraph">
<p>The <code>match</code> property defines a string that the AMQ Broker uses to match address settings to addresses configured on the broker. You can specify an exact address name or use a wildcard expression to match the address settings to a <strong>set</strong> of addresses.</p>
</div>
<div class="paragraph">
<p>When using a wildcard expression as a value for the <code>match</code> property, you <strong>must</strong> enclose the value in single quotation marks (e.g., <code>'myAddresses*'</code>).</p>
</div>
<div class="paragraph">
<div class="title">Wildcard Characters</div>
<p>The AMQ Broker supports two wildcard characters for matching address patterns:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>#</code> (hash): This wildcard character matches any sequence of words, separated by periods. It can only be used at the end of the address string. For example:</p>
</li>
<li>
<p><code>europe-news.#</code> matches <code>europe-news</code>, <code>europe-news.politics</code>, and <code>europe-news.politics.fr</code>.</p>
</li>
<li>
<p><code>*</code> (asterisk): This wildcard character matches a single word. It can be used anywhere within the address string. For example:</p>
</li>
<li>
<p><code>usa-news.*</code> matches <code>usa-news.domestic</code> and <code>usa-news.intl</code>, but not <code>usa-news.domestic.politics</code>.</p>
</li>
<li>
<p><code>finance.*.reports</code> matches <code>finance.monthly.reports</code> but not <code>finance.quarterly.annual.reports</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Note</div>
<p>When configuring <code>brokerProperties</code> entries, a period (<code>.</code>) is a reserved character. If you intend to create an address pattern that contains a period and want it to be treated literally rather than as a separator for words in a wildcard expression, you must enclose the entire address pattern in quotation marks. For example, <code>"usa-news.*"</code> ensures the pattern matching works as expected with the period.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Type</strong>: string</p>
</li>
<li>
<p><strong>Example</strong>: <code>'myAddresses*'</code>, <code>'queue.example.#'</code>, <code>myExactQueue</code></p>
</li>
<li>
<p><strong>Default value</strong>: None</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_hands_on_activity_configuring_address_settings_with_match"><a class="anchor" href="#_hands_on_activity_configuring_address_settings_with_match"></a>Hands-on Activity: Configuring Address Settings with <code>match</code></h4>
<div class="paragraph">
<p>In this activity, you will configure address settings for an AMQ Broker instance on OpenShift using the <code>ActiveMQArtemis</code> custom resource (CR). You will define two different address settings, each using the <code>match</code> property to target specific addresses or address patterns.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>An OpenShift cluster with the AMQ Broker Operator installed.</p>
</li>
<li>
<p>An <code>ActiveMQArtemis</code> instance already deployed, named <code>ex-all-artemis</code> in the <code>my-broker-project</code> namespace. If you don&#8217;t have one, you can deploy a basic instance using the command:
<code><code>bash
oc apply -f - &lt;&lt;EOF
apiVersion: broker.amq.io/v1beta1
kind: ActiveMQArtemis
metadata:
  name: ex-all-artemis
  namespace: my-broker-project
spec:
  deploymentPlan:
    size: 1
EOF
</code></code></p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Steps</div>
<ol class="arabic">
<li>
<p><strong>Log in to OpenShift</strong>
Ensure you are logged in to your OpenShift cluster and are in the correct project:
<code><code>bash
oc login -u developer -p developer
oc project my-broker-project
</code></code></p>
</li>
<li>
<p><strong>Edit the ActiveMQArtemis CR</strong>
You will edit the <code>ex-all-artemis</code> instance to add address settings. Open the CR for editing:
<code><code>bash
oc edit ActiveMQArtemis ex-all-artemis
</code></code></p>
</li>
<li>
<p><strong>Add Address Settings</strong>
Navigate to the <code>spec</code> section and add the <code>addressSettings</code> block as shown below. This configuration includes:</p>
<div class="ulist">
<ul>
<li>
<p>An <code>applyRule: merge_all</code> to ensure our settings are merged with any defaults.</p>
</li>
<li>
<p>An address setting for an exact address <code>myAddress</code> with <code>maxDeliveryAttempts: 5</code>.</p>
</li>
<li>
<p>An address setting for all addresses starting with <code>myOtherAddresses.</code> using the <code>myOtherAddresses#</code> wildcard, setting <code>maxDeliveryAttempts: 3</code>. Note the single quotes around the wildcard pattern.</p>
<div class="literalblock">
<div class="content">
<pre>Modify the `spec` section to include the `addressSettings` block:</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>```yaml
# ... (existing ActiveMQArtemis CR content)
spec:
  # ... (other spec properties)
  addressSettings:
    applyRule: merge_all
    addressSetting:
    - match: myAddress
      deadLetterAddress: myDeadLetterAddress
      maxDeliveryAttempts: 5
    - match: 'myOtherAddresses#'
      deadLetterAddress: myDeadLetterAddress
      maxDeliveryAttempts: 3
# ... (rest of the ActiveMQArtemis CR content)
```</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>Save the changes and exit the editor (`:wq`).</pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Verify the Configuration</strong>
After saving, the AMQ Broker Operator will reconcile the changes. You can check the <code>status</code> section of the <code>ActiveMQArtemis</code> CR for any errors and to ensure the broker pod restarts if necessary.
<code><code>bash
oc get ActiveMQArtemis ex-all-artemis -o yaml | less
</code></code>
Look for a <code>BrokerProperties</code> section or similar in the <code>status</code> to confirm the address settings were applied without issues. You can also inspect the broker logs:
<code><code>bash
oc logs -f $(oc get pod -l app.kubernetes.io/name=ex-all-artemis -o jsonpath='{.items[0].metadata.name}')
</code></code>
Search for messages related to address configuration during broker startup.</p>
</li>
<li>
<p><strong>Test the Address Settings (Optional)</strong>
To fully test, you would connect to the AMQ Broker, create messages for <code>myAddress</code> and addresses like <code>myOtherAddresses.queue1</code>, and observe how <code>maxDeliveryAttempts</code> is applied when messages cannot be delivered successfully (e.g., by simulating consumer failure). This typically involves:</p>
<div class="ulist">
<ul>
<li>
<p>Deploying an application that connects to the broker.</p>
</li>
<li>
<p>Sending messages to <code>myAddress</code> and <code>myOtherAddresses.something</code>.</p>
</li>
<li>
<p>Observing message behavior in case of delivery failures.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>This activity demonstrates how to use the <code>match</code> property within the <code>ActiveMQArtemis</code> CR to configure different address settings based on exact names or wildcard patterns.</p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="address-settings-configuration.html">Address Settings Configuration</a></span>
  <span class="next"><a href="enclosing-value-in-single-quotation-marks-for-example-myotheraddresses.html">Enclosing value in single quotation marks, for example, myOtherAddresses#</a></span>
</nav>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <img src="../../../_/img/rhl-logo-red.png" height="40px" alt="Red Hat"  href="https://redhat.com" >
</footer><script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
